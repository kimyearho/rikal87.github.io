var DataMagnet=function(e,t,a){function i(e,t){var a;switch(a=$(t).is("input, textarea, select, button")?$(t).val():$(t).text(),typeof e){case"number":a=Number(a);break;case"boolean":a="checkbox"===$(t).attr("type")?$(t).is(":checked"):"0"==a||""==a||"false"==a.toLowerCase()?!1:!0}return a}this.dataRef="data-ref",this.deleteSelector=a||!1,console.log(this.deleteSelector),this.scope=$(e),this.dependency=t||!1;var n=0;this.cloneElement=function(e,t,a,i,o){var r=this,s=this.dataRef;for(var c in t)$(e).each(function(e,d){var l=$(d).clone(),h=$(l).attr(s);l.attr("id",null),l.addClass("databinder-created"),l.attr("data-idx",c),r._update(l,t[c],a,i,o,n++),l.insertAfter(1==i||0==$(d).next(".databinder-created").length?d:$(d).nextAll(".databinder-created").last()),void 0!==a&&void 0!==a[h]&&a[h]($(l),t,h),void 0!==a&&a.hasOwnProperty("this")&&a["this"]($(l),t,h)})},this.bind=function(e,t){this.cloneElement(this.scope,e,t,!1,!0),console.log(this.deleteSelector),this.deleteSelector&&$(this.scope).remove()},this.remove=function(){$(this.scope).nextAll(".databinder-created").remove()},this.update=function(e,t){this._update(this.scope,e,t,!1,!1)},this._update=function(e,t,a,n,o,r){var s=this,c=this.dataRef;$(e).find("["+c+"]").each(function(e,d){var l=$(d).attr(c);if(t.hasOwnProperty(l)){if("object"==typeof t[l]&&-1!==t[l].toString().indexOf("Object")){var h;void 0!==a&&a.hasOwnProperty(l)&&(h=a[l]),o&&s.cloneElement($(d),t[l],h,n,o),void 0!==h&&h.hasOwnProperty("this")&&h["this"]($(d),t,l),s.deleteSelector&&$(d).remove()}else s.bindingValueOfElement(d,t,l,s,r),void 0!==a&&void 0!==a.ALL&&a.ALL($(d),t,l);s.dependency&&$(d).change(function(){t[l]=i(t[l],d)})}void 0!==a&&a.hasOwnProperty(l)&&"function"==typeof a[l]&&a[l]($(d),t,l)})},this.insert=function(e,t){this.cloneElement(this.scope,e,t,!0,!0)},this.bindingValueOfElement=function(e,t,a,i,n){if($(e).is("input, textarea, select, button"))switch($(e).prop("type")){case"checkbox":$(e).prop("checked",t[a]);break;case"radio":$(e).prop("name",$(e).attr("name")||$(e).attr(i.dataRef)+"-"+n),$(e).filter("[value="+t[a]+"]").prop("checked",!0);break;default:$(e).val(t[a])}else $(e).text(t[a])}};